---
description: 完了条件が明確なタスクをピックアップして実装し、/close で仕上げるコマンド
---

あなたはタスク実行エージェントです。
`.design/tasks/` から着手可能なタスクを選定し、計画・実装まで行います。実装完了後は `/close` でレビュー・コミット・ステータス更新を行う前提で動きます。

## Step 1: タスク候補の選定

1. `.design/tasks/` 内の `YYYYMMDD-*.md` ファイル（`README.md` を除く）を走査する
2. `## ステータス` セクションが `[x] 未着手` のタスクを抽出する
3. 以下の基準で「着手可能」なタスクを絞り込む：
   - **完了条件が明確**: `## 完了条件` に具体的なチェック項目がある（「〜できる」「〜が通る」等、検証可能な記述）
   - **自己完結**: 外部の意思決定待ちや未決定事項がない
   - **スコープが適切**: 1回の作業セッションで完了できる粒度
4. 候補が0件なら「着手可能なタスクがありません」と報告して終了
5. 候補をユーザーに提示し、どれに着手するか選択してもらう
   - 各候補はタスク名・概要・完了条件の要約を表示する
   - 優先度の情報がタスクにあればそれも表示する

## Step 2: タスクの着手

1. 選択されたタスクファイルのステータスを「進行中」に更新する：
   - `[x] 未着手` → `[ ] 未着手`
   - `[ ] 進行中` → `[x] 進行中`
2. タスクの概要・完了条件を改めて確認する

## Step 2.5: 要件レビュー（3視点並列）

1. review-req スキルを呼び出し、選択されたタスクファイルに対して3エージェント並列レビューを実行する：
   - **PdM Reviewer**: ビジネス価値・KPI整合性・完了条件の検証可能性
   - **Tech Lead Reviewer**: アーキテクチャ整合性・技術的実現可能性・保守性
   - **UX Reviewer**: UI一貫性・直感性・アクセシビリティ
2. 判定分岐：
   - **PASS** → Step 3 へ進む
   - **CONDITIONAL** → WARNING 一覧を表示し、ユーザーに承認を求める。承認されたら Step 3 へ
   - **REJECT** → BLOCKING 一覧を表示し、タスクファイルの修正を促す。BLOCKING が解消されるまで Step 3 に進まない
3. **REJECT 時の再実行フロー**：
   - ユーザーがタスクファイルを修正する
   - 修正後、review-req スキルを再実行する（Step 2.5 をリトライ）
   - PASS または CONDITIONAL（ユーザー承認付き）になるまでループする

## Step 3: plan モードで計画立案

1. EnterPlanMode ツールを使用して plan モードに入る
2. タスクの要件に基づいて実装計画を作成する：
   - 変更が必要なファイルの特定
   - 実装ステップの詳細
   - テスト方針（必要な場合）
3. 設計ドキュメントがあれば参照し、整合性を確認する
4. ユーザーの承認を得てから ExitPlanMode で実装フェーズへ移行

## Step 4: 実装

1. 承認された計画に従って実装を進める
2. Codex MCP が利用可能な場合はレビューに併用する
3. タスクの完了条件を1つずつ確認しながら進める
4. 全ての完了条件を満たすまで作業を続ける

## Step 5: 実装完了の報告と /close への引き渡し

実装が完了したら以下を報告する：

- 実施した変更の要約
- 満たした完了条件の一覧
- 未解決の懸念事項（あれば）

そして以下のメッセージを表示する：

> 実装が完了しました。`/close` を実行してレビュー・コミット・ステータス更新を行ってください。

**このコマンドではコミットやステータスの完了更新は行わない。** それらは `/close` の責務。

## 注意事項

- plan モードでの計画承認なしに実装を開始しない
- 進行中のタスクが既にある場合は、新規着手の前にユーザーに確認する
- `/close` との責務分離：このコマンドは「選定・計画・実装」まで、`/close` は「レビュー・コミット・完了」を担当
